<!DOCTYPE html>
<html lang="en">
<head>
<base href="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/">
<link rel="icon" type="image/png" href="favicon.png" />
<link rel="icon" type="image/png" sizes="32x32" href="/favicon.png" />
<link rel="apple-touch-icon" href="/favicon.png" />
<script>
  window.addEventListener('beforeunload', function (event) {
    event.preventDefault();
    event.returnValue = '';
    return 'Are you sure you want to leave? Any unsaved changes will be lost.';
  });
</script>
<!-- Optional: ad scripts can be deferred or removed for performance -->
<!-- <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> -->
<!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-WX5VS54ZDW"></script> -->
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>gn-math - Space Edition</title>
<meta name="title" content="GN-Math Space" />
<meta name="description" content="Explore cosmic zones and galactic puzzles on GN-Math. Blast off into the space adventure!" />
<!-- Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-WX5VS54ZDW"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-WX5VS54ZDW');
</script>
<style>
/* --- Space Theme CSS --- */
@import url('https://fonts.googleapis.com/css2?family=Orbitron&display=swap');

:root {
  --primary: #00ffff; /* Cyan for stars */
  --primary-hover: #ff00ff; /* Magenta hover */
  --accent: #ffcc00; /* Star yellow accents */
  --success: #00ff00; /* Galactic green */
  --warning: #ff6600; /* Nebula orange */
  --text: #FFFFFF; /* White text */
  --bg: radial-gradient(ellipse at bottom, #000000 0%, #0b1d2e 100%);
  --surface: #222; /* Dark surface for contrast */
  --border: #FFFFFF; /* White border */
  --radius: 12px;
  --font-family: 'Orbitron', cursive, sans-serif;
}

body {
  font-family: var(--font-family);
  line-height: 1.6;
  margin: 0;
  padding: 0;
  background: var(--bg);
  color: var(--text);
  background-image: 
    radial-gradient(circle at top right, #00ffff, transparent 70%), 
    radial-gradient(circle at bottom left, #ffcc00, transparent 70%);
  background-repeat: no-repeat;
  background-attachment: fixed;
  background-size: cover;
  font-weight: 400;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Header with space glow and cosmic colors */
header {
  background: linear-gradient(45deg, #0b1d2e, #000000);
  color: var(--text);
  font-family: var(--font-family);
  position: sticky;
  top: 0;
  z-index: 100;
  padding: 1rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 0 15px rgba(0,255,255,0.3);
  border-bottom: 2px solid #00ffff;
}

/* Glitch/glow animation for header */
@keyframes glitch {
  0% { transform: translate(0); }
  20% { transform: translate(-2px, 0); }
  40% { transform: translate(2px, 0); }
  60% { transform: translate(-2px, 0); }
  80% { transform: translate(2px, 0); }
  100% { transform: translate(0); }
}
header {
  animation: glitch 2s infinite;
}

.logo {
  font-size: 1.75rem;
  font-weight: 800;
  background: linear-gradient(135deg, #00ffff, #ff00ff);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 10px #FFF, 0 0 20px #0ff;
}

/* Search and controls styling with cosmic glow */
.search-container {
  display: flex;
  flex: 1;
  max-width: 500px;
  gap: 0.75rem;
}
#searchBar {
  flex: 1;
  padding: 0.875rem 1rem;
  border: 2px solid #FFFFFF;
  border-radius: var(--radius);
  background: #333;
  color: #FFF;
  font-family: var(--font-family);
  font-size: 15px;
  outline: none;
  transition: all 0.3s ease;
}
#searchBar:focus {
  background: #555;
  border-color: #ffcc00;
  box-shadow: 0 0 10px #ffcc00, inset 0 0 10px #ffcc00;
}
#sortOptions {
  padding: 0.875rem 1rem;
  border: 2px solid #FFFFFF;
  border-radius: var(--radius);
  background: #333;
  color: #FFF;
  font-family: var(--font-family);
  font-size: 15px;
  cursor: pointer;
  transition: all 0.3s ease;
}
#sortOptions:hover {
  background: #555;
  border-color: #ffcc00;
  box-shadow: 0 0 10px #ffcc00;
}

/* Control buttons styling with cosmic glow */
.control-buttons {
  display: flex;
  gap: 0.5rem;
}
#settings {
  background: linear-gradient(45deg, #00ffff, #ffcc00);
  border: none;
  color: #FFF;
  font-size: 1.2rem;
  cursor: pointer;
  padding: 0.75rem;
  border-radius: var(--radius);
  box-shadow: 0 0 10px #FFF, 0 0 20px #FFCC00;
}
#settings:hover {
  box-shadow: 0 0 20px #FFF, inset 0 0 20px #FFCC00;
}

/* Main content styles */
main {
  padding: 2rem 1rem;
  max-width: 1200px;
  margin: auto;
}

/* Zone grid styles with cosmic borders and glow */
#container, #featuredZones {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.5rem;
}
.zone-item {
  background: #222;
  border: 2px solid #00ffff;
  border-radius: var(--radius);
  overflow: hidden;
  cursor: pointer;
  transition: all 0.4s ease;
  display: flex;
  flex-direction: column;
  box-shadow: 0 0 10px #00ffff, inset 0 0 10px #00ffff;
}
.zone-item:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 0 0 20px #00ffff, inset 0 0 20px #00ffff;
  border-color: #ff00ff;
}
.zone-item img {
  width: 100%;
  aspect-ratio: 1;
  object-fit: cover;
  display: block;
  transition: transform 0.4s ease;
}
.zone-item:hover img {
  transform: scale(1.05);
}
.zone-item button {
  background: transparent;
  color: #00ffff;
  border: none;
  padding: 1.25rem 1rem;
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
  text-shadow: 0 0 5px #FFF;
  transition: all 0.3s ease;
}
.zone-item:hover button {
  color: #ff00ff;
  background: rgba(255,255,255,0.1);
}

/* Zone viewer overlay with glow */
#zoneViewer {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  z-index: 1000;
  display: none;
  flex-direction: column;
  animation: slideInUp 0.3s ease;
}
@keyframes slideInUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}
.zone-header {
  background: linear-gradient(45deg, #00ffff, #ff00ff);
  color: #FFF;
  padding: 1rem 1.5rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
  border-bottom: 2px solid #FFF;
}
#zoneName {
  font-size: 1.25rem;
  font-weight: bold;
  margin: 0;
  text-shadow: 0 0 5px #FFF, 0 0 10px #0ff;
}
#zoneAuthor {
  font-size: 14px;
  color: #FFF;
  text-decoration: underline;
}
.zone-controls {
  display: flex;
  gap: 0.75rem;
}
.zone-controls button {
  background: #222;
  border: 2px solid #00ffff;
  color: #FFF;
  padding: 0.625rem 1rem;
  border-radius: var(--radius);
  cursor: pointer;
  font-size: 14px;
  font-weight: bold;
  transition: all 0.3s ease;
}
.zone-controls button:hover {
  background: #444;
  border-color: #ffcc00;
  box-shadow: 0 0 10px #ffcc00;
}
#zoneFrame {
  flex: 1;
  border: none;
  width: 100%;
  height: calc(100vh - 80px);
}

/* Popup overlay with glow */
#popupOverlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.8);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 2000;
  padding: 1rem;
}
.popup {
  background: #222;
  border: 2px solid #ffcc00;
  border-radius: var(--radius);
  max-width: 520px;
  width: 100%;
  max-height: 80vh;
  overflow: auto;
  padding: 1rem;
  box-shadow: 0 0 20px #ffcc00, inset 0 0 20px #ffcc00;
  animation: slideInScale 0.3s ease;
}
@keyframes slideInScale {
  from { transform: scale(0.9) translateY(20px); opacity: 0; }
  to { transform: scale(1) translateY(0); opacity: 1; }
}
.popup-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
}
#popupTitle {
  margin: 0;
  font-size: 1.25rem;
  font-weight: bold;
  color: #ffcc00;
}
#popupClose {
  background: none;
  border: none;
  font-size: 1.5rem;
  color: #ffcc00;
  cursor: pointer;
}
#popupClose:hover {
  color: #ff0000;
}
#popupBody {
  color: #FFF;
}

/* Settings button style */
#settings-button {
  width: 100%;
  padding: 0.875rem 1rem;
  background: linear-gradient(45deg, #00ffff, #ffcc00);
  border: none;
  border-radius: var(--radius);
  color: #FFF;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 0 10px #FFF, 0 0 20px #FFCC00;
}
#settings-button:hover {
  box-shadow: 0 0 20px #FFF, inset 0 0 20px #FFCC00;
}

/* Footer with cosmic glow and colors */
footer {
  background: linear-gradient(45deg, #0b1d2e, #000000);
  color: #FFF;
  text-align: center;
  padding: 1rem;
  font-family: var(--font-family);
  font-size: 12px;
  position: fixed;
  bottom: 0;
  width: 100%;
  z-index: 100;
  box-shadow: 0 -0 15px rgba(0,255,255,0.3);
}

/* Responsive adjustments */
@media(max-width: 768px) {
  header {
    flex-direction: column;
    align-items: flex-start;
  }
  #searchBar {
    width: 100%;
  }
  main {
    padding: 1.5rem 1rem;
  }
  #container, #featuredZones {
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  }
}
</style>
</head>
<body>
<header>
<div class="header-content" style="display:flex; align-items:center; justify-content:space-between; width:100%;">
  <div class="logo">üöÄ GN-Math üöÄ</div>
  <div class="search-container" style="display:flex; align-items:center; gap:0.75rem;">
    <input type="text" id="searchBar" placeholder="Search zones..." oninput="filterZones()" />
    <select id="sortOptions" onchange="sortZones()">
      <option value="name">Name</option>
      <option value="id">ID (Date)</option>
      <option value="popular">Popular</option>
    </select>
  </div>
  <div class="control-buttons">
    <button id="settings" style="background:linear-gradient(45deg, #00ffff, #ffcc00);" onclick="/* your settings logic */">üõ∏</button>
  </div>
</div>
</header>

<!-- Main content -->
<main>
<details id="featuredZonesWrapper" open>
  <summary id="allZonesSummary" style="font-size: 1.2rem; font-weight: bold; cursor: pointer;">üåå Featured Zones üåå</summary>
  <div id="featuredZones" class="zone-container"></div>
</details>
<br /><hr /><br />
<details id="allZonesWrapper" open>
  <summary id="allSummary" style="font-size: 1.2rem; font-weight: bold; cursor: pointer;">üå† All Zones üå†</summary>
  <div id="container">Loading...</div>
</details>
</main>

<!-- Zone viewer overlay -->
<div id="zoneViewer" style="display: none;">
<div class="zone-header">
  <div class="zone-title">
    <h2 id="zoneName">Zone Name</h2>
    <span id="zoneId" style="display:none;"></span>
    <a id="zoneAuthor" href="#" target="_blank" style="color:#FFF;">by Author</a>
  </div>
  <div class="zone-controls">
    <button onclick="fullscreenZone()">üé•</button>
    <button onclick="aboutBlank()">üåê</button>
    <button onclick="downloadZone()">üíæ</button>
    <button onclick="closeZone()">‚úñ</button>
  </div>
</div>
<iframe id="zoneFrame"></iframe>
</div>

<!-- Popup overlay -->
<div id="popupOverlay" style="display: none;">
<div class="popup">
  <div class="popup-header">
    <h3 id="popupTitle">Title</h3>
    <button id="popupClose" onclick="closePopup()">√ó</button>
  </div>
  <div id="popupBody">Content will be here</div>
</div>
</div>

<!-- Scripts -->
<script>
  // Declare and initialize container elements
  const container = document.getElementById('container');
  const featuredContainer = document.getElementById('featuredZones');
  const zoneViewer = document.getElementById('zoneViewer');
  let zoneFrame = document.getElementById('zoneFrame');
  const searchBar = document.getElementById('searchBar');
  const sortOptions = document.getElementById('sortOptions');

  const zonesurls = [
    "https://cdn.jsdelivr.net/%67%68/%67%6e%2d%6d%61%74%68/%61%73%73%65%74%73@%6d%61%69%6e/%7a%6f%6e%65%73%2e%6a%73%6f%6e",
    "https://cdn.jsdelivr.net/gh/gn-math/assets@latest/zones.json",
    "https://cdn.jsdelivr.net/gh/gn-math/assets@master/zones.json",
    "https://cdn.jsdelivr.net/gh/gn-math/assets/zones.json"
  ];

  let zonesURL = zonesurls[Math.floor(Math.random() * zonesurls.length)];
  const coverURL = "https://cdn.jsdelivr.net/gh/gn-math/covers@main";
  const htmlURL = "https://cdn.jsdelivr.net/gh/gn-math/html@main";

  let zones = [];
  let popularityData = {};

  async function listZones() {
    try {
      let sharesponse;
      let shajson;
      let sha;
      try {
        sharesponse = await fetch("https://api.github.com/repos/gn-math/assets/commits?t="+Date.now());
      } catch (error) {}
      if (sharesponse && sharesponse.status === 200) {
        try {
          shajson = await sharesponse.json();
          sha = shajson[0]['sha'];
          if (sha) {
            zonesURL = `https://cdn.jsdelivr.net/gh/gn-math/assets@${sha}/zones.json`;
          }
        } catch (error) {
          try {
            let secondarysharesponse = await fetch("https://raw.githubusercontent.com/gn-math/xml/refs/heads/main/sha.txt?t="+Date.now());
            if (secondarysharesponse && secondarysharesponse.status === 200) {
              sha = (await secondarysharesponse.text()).trim();
              if (sha) {
                zonesURL = `https://cdn.jsdelivr.net/gh/gn-math/assets@${sha}/zones.json`;
              }
            }
          } catch(error) {}
        }
      }
      const response = await fetch(zonesURL+"?t="+Date.now());
      const json = await response.json();
      zones = json;
      zones[0].featured = true; // always gonna be the discord
      await fetchPopularity();
      sortZones();

      // Additional logic remains similar...
    } catch (error) {
      console.error(error);
      container.innerHTML = `Error loading zones: ${error}`;
    }
  }

  // Rest of your script functions remain unchanged...
  // (Filtering, opening zones, etc., are unchanged)
</script>
<script>
  const search = new URLSearchParams(window.location.search);
  const privacy = search.get('privacy');
  if (privacy) {
    // Load privacy policy if needed
  }
</script>
</body>
</html>
