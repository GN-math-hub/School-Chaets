<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>GN-Stream</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0a0a;
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    :root {
      --primary-red: #e50914;
      --dark-red: #b20710;
      --black: #0a0a0a;
      --dark-gray: #141414;
      --medium-gray: #2f2f2f;
      --light-gray: #808080;
    }

    /* Header */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 70px;
      background: linear-gradient(180deg, rgba(0,0,0,0.9) 0%, transparent 100%);
      backdrop-filter: blur(10px);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 4%;
      transition: background 0.3s;
    }

    header.scrolled {
      background: rgba(0,0,0,0.95);
    }

    .logo {
      font-size: 32px;
      font-weight: 900;
      color: var(--primary-red);
      letter-spacing: -1px;
      text-transform: uppercase;
    }

    .nav-links {
      display: flex;
      gap: 30px;
      align-items: center;
    }

    .nav-links a {
      color: #fff;
      text-decoration: none;
      font-size: 14px;
      font-weight: 500;
      transition: color 0.3s;
      cursor: pointer;
    }

    .nav-links a:hover {
      color: var(--primary-red);
    }

    .my-list-badge {
      background: var(--primary-red);
      color: #fff;
      padding: 2px 8px;
      border-radius: 12px;
      font-size: 12px;
      margin-left: 5px;
    }

    /* Hero Section - Big Menu */
    .hero-section {
      margin-top: 0;
      height: 85vh;
      position: relative;
      display: flex;
      align-items: center;
      padding: 0 4%;
      background: linear-gradient(135deg, #1a0000 0%, #0a0a0a 50%, #1a0000 100%);
      overflow: hidden;
    }

    .hero-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(circle at 20% 50%, rgba(229, 9, 20, 0.15) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(139, 0, 0, 0.2) 0%, transparent 50%);
      pointer-events: none;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 700px;
    }

    .hero-title {
      font-size: 72px;
      font-weight: 900;
      margin-bottom: 20px;
      background: linear-gradient(135deg, #fff 0%, var(--primary-red) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      line-height: 1;
      text-transform: uppercase;
      letter-spacing: -2px;
    }

    .hero-subtitle {
      font-size: 20px;
      color: #ccc;
      margin-bottom: 40px;
      line-height: 1.6;
    }

    .search-container {
      display: flex;
      gap: 16px;
      max-width: 800px;
    }

    #searchInput {
      flex: 1;
      padding: 18px 28px;
      font-size: 16px;
      border-radius: 8px;
      border: 2px solid transparent;
      background: rgba(255,255,255,0.1);
      color: #fff;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
    }

    #searchInput::placeholder { color: #888; }
    #searchInput:focus { 
      outline: none; 
      background: rgba(255,255,255,0.15);
      border-color: var(--primary-red);
    }

    #ratingSelect {
      min-width: 160px;
      padding: 18px 24px;
      border-radius: 8px;
      font-size: 15px;
      background: rgba(255,255,255,0.1);
      color: #fff;
      border: 2px solid transparent;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg ' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23e50914' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 16px;
      padding-right: 40px;
    }
    #ratingSelect:hover { border-color: var(--primary-red); }

    /* Category Sections - Hulu Style Horizontal Scroll */
    .category-section {
      margin: 60px 0;
      padding: 0 4%;
    }

    .category-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 20px;
    }

    .category-title {
      font-size: 24px;
      font-weight: 700;
      color: #fff;
      display: flex;
      align-items: center;
      gap: 12px;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .category-title::after {
      content: '‚Ä∫';
      color: var(--primary-red);
      font-size: 28px;
      opacity: 0;
      transform: translateX(-10px);
      transition: all 0.3s ease;
    }

    .category-section:hover .category-title::after {
      opacity: 1;
      transform: translateX(0);
    }

    /* Row Container with Navigation */
    .row-container {
      position: relative;
      margin: 0 -4%;
      padding: 0 4%;
    }

    .movie-row {
      display: flex;
      gap: 8px;
      overflow-x: auto;
      overflow-y: hidden;
      scroll-behavior: smooth;
      padding: 20px 0;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    .movie-row::-webkit-scrollbar {
      display: none;
    }

    /* Cards - 30+ per row (compact) */
    .card {
      flex: 0 0 auto;
      width: calc(3.33% - 7.7px); /* ~30 per row */
      min-width: 100px;
      max-width: 140px;
      aspect-ratio: 2/3;
      border-radius: 4px;
      overflow: hidden;
      cursor: pointer;
      position: relative;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      background: #1a1a1a;
      border: 1px solid transparent;
    }

    .card:hover { 
      transform: scale(1.4);
      z-index: 100;
      box-shadow: 0 20px 40px rgba(0,0,0,0.9);
      border-color: var(--primary-red);
    }

    .card img { 
      width: 100%; 
      height: 100%; 
      object-fit: cover; 
      display: block;
    }

    .card-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 40px 8px 8px;
      background: linear-gradient(transparent, rgba(0,0,0,0.95));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .card:hover .card-overlay {
      opacity: 1;
    }

    .card-title {
      font-size: 11px;
      font-weight: 600;
      color: #fff;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .card-rating {
      font-size: 10px;
      color: var(--primary-red);
      margin-top: 2px;
      font-weight: 700;
    }

    .add-to-list-btn {
      position: absolute;
      top: 8px;
      right: 8px;
      width: 28px;
      height: 28px;
      background: rgba(0,0,0,0.7);
      border: 2px solid rgba(255,255,255,0.5);
      border-radius: 50%;
      color: #fff;
      font-size: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      opacity: 0;
      transition: all 0.3s;
      z-index: 10;
    }

    .card:hover .add-to-list-btn {
      opacity: 1;
    }

    .add-to-list-btn:hover {
      background: var(--primary-red);
      border-color: var(--primary-red);
      transform: scale(1.1);
    }

    .add-to-list-btn.in-list {
      background: var(--primary-red);
      border-color: var(--primary-red);
      opacity: 1;
    }

    /* Navigation Arrows */
    .row-nav {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 60px;
      height: 100%;
      background: rgba(0,0,0,0.7);
      border: none;
      color: #fff;
      font-size: 32px;
      cursor: pointer;
      opacity: 0;
      transition: all 0.3s ease;
      z-index: 50;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .row-container:hover .row-nav {
      opacity: 1;
    }

    .row-nav:hover {
      background: rgba(229, 9, 20, 0.9);
    }

    .row-nav.prev { left: 0; }
    .row-nav.next { right: 0; }

    /* My List Section */
    #myListSection {
      display: none;
      background: linear-gradient(180deg, #1a0000 0%, #0a0a0a 100%);
      padding: 40px 4%;
      margin: 40px 0;
      border-top: 2px solid var(--primary-red);
      border-bottom: 2px solid var(--primary-red);
    }

    #myListSection.active {
      display: block;
    }

    /* Details Modal */
    #detailsModal {
      position: fixed;
      inset: 0;
      background-color: rgba(0,0,0,0.95);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      padding: 40px;
    }

    #detailsContent {
      width: 100%;
      max-width: 900px;
      background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);
      border-radius: 12px;
      overflow: hidden;
      position: relative;
      border: 1px solid #333;
      box-shadow: 0 25px 50px rgba(229, 9, 20, 0.3);
    }

    #detailsHeader {
      position: relative;
      height: 400px;
      background-size: cover;
      background-position: center;
    }

    #detailsHeader::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 100%;
      background: linear-gradient(transparent 0%, #0a0a0a 100%);
    }

    .details-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 40px;
      z-index: 2;
    }

    .details-title {
      font-size: 48px;
      font-weight: 900;
      margin-bottom: 16px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }

    .details-meta {
      display: flex;
      gap: 20px;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }

    .details-rating {
      background: var(--primary-red);
      color: #fff;
      padding: 6px 16px;
      border-radius: 4px;
      font-weight: 700;
      font-size: 14px;
    }

    .details-year, .details-genre, .details-runtime {
      color: #ccc;
      font-size: 14px;
    }

    .details-actions {
      display: flex;
      gap: 12px;
      margin-top: 20px;
      flex-wrap: wrap;
    }

    .btn-primary {
      background: #fff;
      color: #000;
      border: none;
      padding: 12px 32px;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .btn-primary:hover {
      background: rgba(255,255,255,0.8);
    }

    .btn-secondary {
      background: rgba(255,255,255,0.1);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.4);
      padding: 12px 32px;
      border-radius: 4px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.3s;
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.2);
    }

    .btn-red {
      background: var(--primary-red);
      color: #fff;
      border: none;
    }

    .btn-red:hover {
      background: var(--dark-red);
    }

    #detailsBody {
      padding: 40px;
    }

    .details-section {
      margin-bottom: 32px;
    }

    .details-section h3 {
      font-size: 20px;
      margin-bottom: 12px;
      color: #fff;
    }

    .details-section p {
      color: #ccc;
      line-height: 1.6;
      font-size: 16px;
    }

    .cast-list {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
    }

    .cast-member {
      background: rgba(255,255,255,0.1);
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 14px;
      color: #fff;
    }

    #closeDetails {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(0,0,0,0.7);
      border: 2px solid rgba(255,255,255,0.3);
      color: #fff;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 20px;
      cursor: pointer;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
    }

    #closeDetails:hover {
      background: var(--primary-red);
      border-color: var(--primary-red);
    }

    /* Player Modal */
    #playerModal {
      position: fixed;
      inset: 0;
      background-color: rgba(0,0,0,0.98);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      padding: 20px;
    }

    #playerContent {
      width: 100%;
      max-width: 1200px;
      background: #000;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
    }

    #playerIframe {
      width: 100%;
      height: 600px;
      border: none;
    }

    #closePlayer {
      position: absolute;
      top: -50px;
      right: 0;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 18px;
      cursor: pointer;
      padding: 10px 20px;
    }

    /* Episode Selector */
    .episode-selector {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 8px;
      padding: 20px;
      margin-top: 20px;
    }

    .selector-row {
      display: flex;
      gap: 16px;
      margin-bottom: 16px;
      align-items: center;
    }

    .selector-row:last-child {
      margin-bottom: 0;
    }

    .selector-label {
      font-size: 14px;
      font-weight: 600;
      color: #fff;
      min-width: 80px;
    }

    .selector-select {
      flex: 1;
      padding: 10px 16px;
      background: rgba(255,255,255,0.1);
      border: 1px solid rgba(255,255,255,0.2);
      border-radius: 4px;
      color: #fff;
      font-size: 14px;
      cursor: pointer;
    }

    .selector-select:focus {
      outline: none;
      border-color: var(--primary-red);
    }

    .selector-select option {
      background: #1a1a1a;
      color: #fff;
    }

    .episode-info {
      font-size: 13px;
      color: #888;
      margin-top: 8px;
      font-style: italic;
    }

    /* Responsive */
    @media (max-width: 1600px) {
      .card { width: calc(4% - 7.68px); } /* 25 per row */
    }
    @media (max-width: 1400px) {
      .card { width: calc(5% - 7.6px); } /* 20 per row */
    }
    @media (max-width: 1200px) {
      .card { width: calc(6.25% - 7.5px); } /* 16 per row */
      .hero-title { font-size: 56px; }
    }
    @media (max-width: 992px) {
      .card { width: calc(8.33% - 7.33px); } /* 12 per row */
      .hero-title { font-size: 42px; }
      .details-title { font-size: 32px; }
    }
    @media (max-width: 768px) {
      .card { width: calc(10% - 7.2px); } /* 10 per row */
      .search-container { flex-direction: column; }
      .hero-title { font-size: 36px; }
      .nav-links { display: none; }
      .selector-row { flex-direction: column; align-items: stretch; }
      .selector-label { min-width: auto; }
    }
    @media (max-width: 480px) {
      .card { width: calc(16.66% - 6.67px); } /* 6 per row */
      .hero-title { font-size: 28px; }
    }

    /* Loading */
    #loadingIndicator {
      display: none;
      justify-content: center;
      align-items: center;
      gap: 12px;
      padding: 60px;
      color: var(--primary-red);
    }

    .dots { display:inline-flex; gap:6px; }
    .dots span {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--primary-red);
      animation: bounce 1.4s infinite ease-in-out both;
    }
    .dots span:nth-child(1) { animation-delay: -0.32s; }
    .dots span:nth-child(2) { animation-delay: -0.16s; }
    @keyframes bounce {
      0%, 80%, 100% { transform: scale(0); }
      40% { transform: scale(1); }
    }

    /* Search Results */
    #searchResults {
      display: none;
      padding: 0 4%;
      margin-top: 100px;
    }

    #searchResults.active {
      display: block;
    }

    .search-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header id="mainHeader">
    <div class="logo">GN-STREAM</div>
    <nav class="nav-links">
      <a onclick="showHome()">Home</a>
      <a onclick="showMyList()">My List <span id="myListCount" class="my-list-badge" style="display:none">0</span></a>
      <a onclick="scrollToSection('movies')">Movies</a>
      <a onclick="scrollToSection('tv')">TV Shows</a>
      <a onclick="scrollToSection('action')">Action</a>
      <a onclick="scrollToSection('comedy')">Comedy</a>
      <a onclick="scrollToSection('horror')">Horror</a>
    </nav>
  </header>

  <!-- Hero Section -->
  <div class="hero-section" id="homeHero">
    <div class="hero-content">
      <div class="hero-title">Unlimited Entertainment</div>
      <div class="hero-subtitle">Watch thousands of movies and TV shows. Add to your list, discover new favorites, and stream instantly.</div>
      <div class="search-container">
        <input id="searchInput" placeholder="Search titles, genres, people..." autocomplete="off" />
        <select id="ratingSelect">
          <option value="all">All Ratings</option>
          <option value="gpg">G / PG</option>
          <option value="pg13">PG-13</option>
          <option value="r">R</option>
          <option value="nc17">NC-17 / Other</option>
        </select>
      </div>
    </div>
  </div>

  <!-- My List Section -->
  <div id="myListSection">
    <div class="category-header">
      <div class="category-title" style="color: var(--primary-red);">My List</div>
    </div>
    <div class="movie-row" id="myListRow"></div>
  </div>

  <!-- Main Categories Container -->
  <div id="categoriesContainer">
    <!-- Trending Now -->
    <div class="category-section" id="section-trending">
      <div class="category-header">
        <div class="category-title">üî• Trending Now</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('trendingRow', -1)">‚Äπ</button>
        <div class="movie-row" id="trendingRow"></div>
        <button class="row-nav next" onclick="scrollRow('trendingRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Popular Movies -->
    <div class="category-section" id="section-movies">
      <div class="category-header">
        <div class="category-title">üé¨ Popular Movies</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('popularMoviesRow', -1)">‚Äπ</button>
        <div class="movie-row" id="popularMoviesRow"></div>
        <button class="row-nav next" onclick="scrollRow('popularMoviesRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Popular TV Shows -->
    <div class="category-section" id="section-tv">
      <div class="category-header">
        <div class="category-title">üì∫ Popular TV Shows</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('popularTvRow', -1)">‚Äπ</button>
        <div class="movie-row" id="popularTvRow"></div>
        <button class="row-nav next" onclick="scrollRow('popularTvRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Action & Adventure -->
    <div class="category-section" id="section-action">
      <div class="category-header">
        <div class="category-title">üí• Action & Adventure</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('actionRow', -1)">‚Äπ</button>
        <div class="movie-row" id="actionRow"></div>
        <button class="row-nav next" onclick="scrollRow('actionRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Comedy -->
    <div class="category-section" id="section-comedy">
      <div class="category-header">
        <div class="category-title">üòÇ Comedy</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('comedyRow', -1)">‚Äπ</button>
        <div class="movie-row" id="comedyRow"></div>
        <button class="row-nav next" onclick="scrollRow('comedyRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Horror -->
    <div class="category-section" id="section-horror">
      <div class="category-header">
        <div class="category-title">üëª Horror</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('horrorRow', -1)">‚Äπ</button>
        <div class="movie-row" id="horrorRow"></div>
        <button class="row-nav next" onclick="scrollRow('horrorRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Sci-Fi -->
    <div class="category-section" id="section-scifi">
      <div class="category-header">
        <div class="category-title">üöÄ Sci-Fi</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('scifiRow', -1)">‚Äπ</button>
        <div class="movie-row" id="scifiRow"></div>
        <button class="row-nav next" onclick="scrollRow('scifiRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Romance -->
    <div class="category-section" id="section-romance">
      <div class="category-header">
        <div class="category-title">‚ù§Ô∏è Romance</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('romanceRow', -1)">‚Äπ</button>
        <div class="movie-row" id="romanceRow"></div>
        <button class="row-nav next" onclick="scrollRow('romanceRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Thriller -->
    <div class="category-section" id="section-thriller">
      <div class="category-header">
        <div class="category-title">üî™ Thriller</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('thrillerRow', -1)">‚Äπ</button>
        <div class="movie-row" id="thrillerRow"></div>
        <button class="row-nav next" onclick="scrollRow('thrillerRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Drama -->
    <div class="category-section" id="section-drama">
      <div class="category-header">
        <div class="category-title">üé≠ Drama</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('dramaRow', -1)">‚Äπ</button>
        <div class="movie-row" id="dramaRow"></div>
        <button class="row-nav next" onclick="scrollRow('dramaRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Animation -->
    <div class="category-section" id="section-animation">
      <div class="category-header">
        <div class="category-title">üé® Animation</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('animationRow', -1)">‚Äπ</button>
        <div class="movie-row" id="animationRow"></div>
        <button class="row-nav next" onclick="scrollRow('animationRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Documentary -->
    <div class="category-section" id="section-documentary">
      <div class="category-header">
        <div class="category-title">üìπ Documentary</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('documentaryRow', -1)">‚Äπ</button>
        <div class="movie-row" id="documentaryRow"></div>
        <button class="row-nav next" onclick="scrollRow('documentaryRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Crime -->
    <div class="category-section" id="section-crime">
      <div class="category-header">
        <div class="category-title">üöî Crime</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('crimeRow', -1)">‚Äπ</button>
        <div class="movie-row" id="crimeRow"></div>
        <button class="row-nav next" onclick="scrollRow('crimeRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Fantasy -->
    <div class="category-section" id="section-fantasy">
      <div class="category-header">
        <div class="category-title">üßô Fantasy</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('fantasyRow', -1)">‚Äπ</button>
        <div class="movie-row" id="fantasyRow"></div>
        <button class="row-nav next" onclick="scrollRow('fantasyRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- War -->
    <div class="category-section" id="section-war">
      <div class="category-header">
        <div class="category-title">‚öîÔ∏è War</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('warRow', -1)">‚Äπ</button>
        <div class="movie-row" id="warRow"></div>
        <button class="row-nav next" onclick="scrollRow('warRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Western -->
    <div class="category-section" id="section-western">
      <div class="category-header">
        <div class="category-title">ü§† Western</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('westernRow', -1)">‚Äπ</button>
        <div class="movie-row" id="westernRow"></div>
        <button class="row-nav next" onclick="scrollRow('westernRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Family -->
    <div class="category-section" id="section-family">
      <div class="category-header">
        <div class="category-title">üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('familyRow', -1)">‚Äπ</button>
        <div class="movie-row" id="familyRow"></div>
        <button class="row-nav next" onclick="scrollRow('familyRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Mystery -->
    <div class="category-section" id="section-mystery">
      <div class="category-header">
        <div class="category-title">üîç Mystery</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('mysteryRow', -1)">‚Äπ</button>
        <div class="movie-row" id="mysteryRow"></div>
        <button class="row-nav next" onclick="scrollRow('mysteryRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- Music/Musical -->
    <div class="category-section" id="section-music">
      <div class="category-header">
        <div class="category-title">üéµ Music & Musical</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('musicRow', -1)">‚Äπ</button>
        <div class="movie-row" id="musicRow"></div>
        <button class="row-nav next" onclick="scrollRow('musicRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- History -->
    <div class="category-section" id="section-history">
      <div class="category-header">
        <div class="category-title">üèõÔ∏è History</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('historyRow', -1)">‚Äπ</button>
        <div class="movie-row" id="historyRow"></div>
        <button class="row-nav next" onclick="scrollRow('historyRow', 1)">‚Ä∫</button>
      </div>
    </div>

    <!-- TV Movie -->
    <div class="category-section" id="section-tvmovie">
      <div class="category-header">
        <div class="category-title">üì° TV Movie</div>
      </div>
      <div class="row-container">
        <button class="row-nav prev" onclick="scrollRow('tvMovieRow', -1)">‚Äπ</button>
        <div class="movie-row" id="tvMovieRow"></div>
        <button class="row-nav next" onclick="scrollRow('tvMovieRow', 1)">‚Ä∫</button>
      </div>
    </div>
  </div>

  <!-- Search Results -->
  <div id="searchResults">
    <div class="category-header">
      <div class="category-title">Search Results</div>
    </div>
    <div class="search-grid" id="searchResultsGrid"></div>
  </div>

  <div id="loadingIndicator">
    <div class="dots"><span></span><span></span><span></span></div>
  </div>

  <!-- Details Modal -->
  <div id="detailsModal">
    <div id="detailsContent">
      <button id="closeDetails" onclick="closeDetails()">‚úï</button>
      <div id="detailsHeader" style="background-image: url('')">
        <div class="details-info">
          <div class="details-title" id="detailsTitle"></div>
          <div class="details-meta">
            <span class="details-rating" id="detailsRating">NR</span>
            <span class="details-year" id="detailsYear"></span>
            <span class="details-runtime" id="detailsRuntime"></span>
            <span class="details-genre" id="detailsGenre"></span>
          </div>
          <div class="details-actions">
            <button class="btn-primary" onclick="playContent()">
              <span>‚ñ∂</span> Play
            </button>
            <button class="btn-secondary" id="detailsAddToList" onclick="toggleListFromDetails()">
              <span>+</span> My List
            </button>
          </div>
          
          <!-- Episode Selector for TV Shows -->
          <div id="episodeSelector" class="episode-selector" style="display: none;">
            <div class="selector-row">
              <span class="selector-label">Season:</span>
              <select id="seasonSelect" class="selector-select" onchange="onSeasonChange()">
                <option value="">Select Season</option>
              </select>
            </div>
            <div class="selector-row">
              <span class="selector-label">Episode:</span>
              <select id="episodeSelect" class="selector-select" onchange="onEpisodeChange()">
                <option value="">Select Episode</option>
              </select>
            </div>
            <div id="episodeInfo" class="episode-info"></div>
          </div>
        </div>
      </div>
      <div id="detailsBody">
        <div class="details-section">
          <h3>Overview</h3>
          <p id="detailsOverview"></p>
        </div>
        <div class="details-section">
          <h3>Cast</h3>
          <div class="cast-list" id="detailsCast"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Player Modal -->
  <div id="playerModal">
    <div id="playerContent">
      <button id="closePlayer" onclick="closePlayer()">‚úï Close</button>
      <iframe id="playerIframe" allowfullscreen></iframe>
    </div>
  </div>

  <script>
    // API Setup
    const API_KEY = '3a73619bbb8fc6d47742d1b5b2b707b5';
    const baseURL = 'https://api.themoviedb.org/3';
    const FALLBACK_POSTER = 'https://via.placeholder.com/300x450/1a1a1a/666?text=No+Poster';
    const FALLBACK_BACKDROP = 'https://via.placeholder.com/1280x720/1a1a1a/666?text=No+Backdrop';

    // State
    let myList = JSON.parse(localStorage.getItem('gnStreamMyList')) || [];
    let currentItem = null;
    let currentDetailsItem = null;
    let tvSeasonsData = [];
    let currentSeason = 1;
    let currentEpisode = 1;

    // Elements
    const searchInput = document.getElementById('searchInput');
    const ratingSelect = document.getElementById('ratingSelect');
    const categoriesContainer = document.getElementById('categoriesContainer');
    const searchResults = document.getElementById('searchResults');
    const myListSection = document.getElementById('myListSection');

    // Header scroll effect
    window.addEventListener('scroll', () => {
      const header = document.getElementById('mainHeader');
      if (window.scrollY > 50) {
        header.classList.add('scrolled');
      } else {
        header.classList.remove('scrolled');
      }
    });

    // Scroll row function
    function scrollRow(rowId, direction) {
      const row = document.getElementById(rowId);
      const scrollAmount = row.clientWidth * 0.9;
      row.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });
    }

    // Show/Hide sections
    function showHome() {
      myListSection.classList.remove('active');
      categoriesContainer.style.display = 'block';
      searchResults.classList.remove('active');
      document.getElementById('homeHero').style.display = 'flex';
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function showMyList() {
      renderMyList();
      myListSection.classList.add('active');
      categoriesContainer.style.display = 'none';
      searchResults.classList.remove('active');
      document.getElementById('homeHero').style.display = 'none';
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function scrollToSection(section) {
      const element = document.getElementById(`section-${section}`);
      if (element) {
        element.scrollIntoView({ behavior: 'smooth' });
      }
    }

    // My List Functions
    function toggleMyList(item, btn) {
      const index = myList.findIndex(i => i.id === item.id);
      if (index === -1) {
        myList.push(item);
        btn.classList.add('in-list');
        btn.innerHTML = '‚úì';
      } else {
        myList.splice(index, 1);
        btn.classList.remove('in-list');
        btn.innerHTML = '+';
      }
      localStorage.setItem('gnStreamMyList', JSON.stringify(myList));
      updateMyListCount();
    }

    function toggleListFromDetails() {
      if (!currentDetailsItem) return;
      const index = myList.findIndex(i => i.id === currentDetailsItem.id);
      const btn = document.getElementById('detailsAddToList');
      
      if (index === -1) {
        myList.push(currentDetailsItem);
        btn.innerHTML = '<span>‚úì</span> In My List';
        btn.classList.add('btn-red');
      } else {
        myList.splice(index, 1);
        btn.innerHTML = '<span>+</span> My List';
        btn.classList.remove('btn-red');
      }
      localStorage.setItem('gnStreamMyList', JSON.stringify(myList));
      updateMyListCount();
      renderMyList();
    }

    function updateMyListCount() {
      const badge = document.getElementById('myListCount');
      if (myList.length > 0) {
        badge.textContent = myList.length;
        badge.style.display = 'inline';
      } else {
        badge.style.display = 'none';
      }
    }

    function renderMyList() {
      const container = document.getElementById('myListRow');
      container.innerHTML = '';
      
      if (myList.length === 0) {
        container.innerHTML = '<div style="color: #666; padding: 40px; width: 100%; text-align: center;">Your list is empty. Add movies and shows to watch later!</div>';
        return;
      }

      myList.forEach(item => {
        createCard(item, container, true);
      });
    }

    // Sources - Vidify Only
    function getTvSources(id, season, episode) {
      return [`https://player.vidify.top/embed/tv/${id}/${season}/${episode}?autoplay=false&poster=true`];
    }

    function getMovieSources(id) {
      return [`https://player.vidify.top/embed/movie/${id}?autoplay=false&poster=true`];
    }

    // Rating helpers
    async function getCertification(item) {
      try {
        if (item.media_type === 'tv' || item.first_air_date) {
          const res = await fetch(`${baseURL}/tv/${item.id}/content_ratings?api_key=${API_KEY}`);
          const data = await res.json();
          const us = data.results?.find(r => r.iso_3166_1 === 'US');
          return us?.rating || 'NR';
        } else {
          const res = await fetch(`${baseURL}/movie/${item.id}/release_dates?api_key=${API_KEY}`);
          const data = await res.json();
          const us = data.results?.find(r => r.iso_3166_1 === 'US');
          return us?.release_dates?.[0]?.certification || 'NR';
        }
      } catch (e) { return 'NR'; }
    }

    function certMatchesGroup(cert, group) {
      if (group === 'all') return true;
      cert = (cert || '').toUpperCase();
      if (group === 'gpg') return ['G','PG','TV-Y','TV-G','TV-Y7'].includes(cert);
      if (group === 'pg13') return cert === 'PG-13' || cert === 'TV-14';
      if (group === 'r') return cert === 'R' || cert === 'TV-MA';
      if (group === 'nc17') return cert === 'NC-17' || !['G','PG','PG-13','R','TV-14','TV-MA'].includes(cert);
      return false;
    }

    // Create card
    function createCard(item, container, isList = false) {
      const cert = item._cert || 'NR';
      const card = document.createElement('div');
      card.className = 'card';
      
      const inList = myList.some(i => i.id === item.id);
      
      card.innerHTML = `
        <img src="${item.poster_path ? `https://image.tmdb.org/t/p/w300${item.poster_path}` : FALLBACK_POSTER}" 
             alt="${item.title || item.name}" loading="lazy">
        <div class="card-overlay">
          <div class="card-title">${item.title || item.name}</div>
          <div class="card-rating">‚òÖ ${(item.vote_average || 0).toFixed(1)} ‚Ä¢ ${cert}</div>
        </div>
        <button class="add-to-list-btn ${inList ? 'in-list' : ''}" onclick="event.stopPropagation(); toggleMyList(${JSON.stringify(item).replace(/"/g, '&quot;')}, this)">
          ${inList ? '‚úì' : '+'}
        </button>
      `;
      
      card.onclick = () => openDetails(item);
      container.appendChild(card);
    }

    // Load TV Show Seasons
    async function loadTvSeasons(tvId) {
      try {
        const res = await fetch(`${baseURL}/tv/${tvId}?api_key=${API_KEY}&language=en-US`);
        const data = await res.json();
        tvSeasonsData = data.seasons || [];
        
        // Filter out specials (season 0) usually
        tvSeasonsData = tvSeasonsData.filter(s => s.season_number > 0);
        
        const seasonSelect = document.getElementById('seasonSelect');
        seasonSelect.innerHTML = '<option value="">Select Season</option>';
        
        tvSeasonsData.forEach(season => {
          const option = document.createElement('option');
          option.value = season.season_number;
          option.textContent = `Season ${season.season_number} (${season.episode_count} episodes)`;
          seasonSelect.appendChild(option);
        });
        
        // Auto-select first season
        if (tvSeasonsData.length > 0) {
          seasonSelect.value = tvSeasonsData[0].season_number;
          await onSeasonChange();
        }
      } catch (e) {
        console.error('Error loading seasons:', e);
      }
    }

    // Season Change Handler
    async function onSeasonChange() {
      const seasonSelect = document.getElementById('seasonSelect');
      const episodeSelect = document.getElementById('episodeSelect');
      const seasonNum = parseInt(seasonSelect.value);
      
      if (!seasonNum) return;
      
      currentSeason = seasonNum;
      
      try {
        const res = await fetch(`${baseURL}/tv/${currentDetailsItem.id}/season/${seasonNum}?api_key=${API_KEY}&language=en-US`);
        const data = await res.json();
        
        episodeSelect.innerHTML = '<option value="">Select Episode</option>';
        
        if (data.episodes) {
          data.episodes.forEach(ep => {
            const option = document.createElement('option');
            option.value = ep.episode_number;
            option.textContent = `Episode ${ep.episode_number}: ${ep.name}`;
            episodeSelect.appendChild(option);
          });
          
          // Auto-select first episode
          if (data.episodes.length > 0) {
            episodeSelect.value = 1;
            currentEpisode = 1;
            updateEpisodeInfo(data.episodes[0]);
          }
        }
      } catch (e) {
        console.error('Error loading episodes:', e);
      }
    }

    // Episode Change Handler
    function onEpisodeChange() {
      const episodeSelect = document.getElementById('episodeSelect');
      currentEpisode = parseInt(episodeSelect.value) || 1;
      
      // Find episode info
      const seasonNum = parseInt(document.getElementById('seasonSelect').value);
      fetch(`${baseURL}/tv/${currentDetailsItem.id}/season/${seasonNum}?api_key=${API_KEY}&language=en-US`)
        .then(res => res.json())
        .then(data => {
          const episode = data.episodes?.find(e => e.episode_number === currentEpisode);
          if (episode) updateEpisodeInfo(episode);
        });
    }

    // Update Episode Info Display
    function updateEpisodeInfo(episode) {
      const infoDiv = document.getElementById('episodeInfo');
      if (episode.overview) {
        infoDiv.textContent = episode.overview.substring(0, 150) + (episode.overview.length > 150 ? '...' : '');
      } else {
        infoDiv.textContent = `Episode ${episode.episode_number} - ${episode.name}`;
      }
    }

    // Open Details Modal
    async function openDetails(item) {
      currentDetailsItem = item;
      const modal = document.getElementById('detailsModal');
      const content = document.getElementById('detailsContent');
      
      // Reset episode selector
      document.getElementById('episodeSelector').style.display = 'none';
      document.getElementById('seasonSelect').innerHTML = '<option value="">Select Season</option>';
      document.getElementById('episodeSelect').innerHTML = '<option value="">Select Episode</option>';
      document.getElementById('episodeInfo').textContent = '';
      
      // Set basic info
      document.getElementById('detailsTitle').textContent = item.title || item.name;
      document.getElementById('detailsRating').textContent = item._cert || 'NR';
      document.getElementById('detailsYear').textContent = (item.release_date || item.first_air_date || '').substring(0, 4);
      document.getElementById('detailsOverview').textContent = item.overview || 'No overview available.';
      
      // Set backdrop
      const backdropUrl = item.backdrop_path 
        ? `https://image.tmdb.org/t/p/original${item.backdrop_path}`
        : FALLBACK_BACKDROP;
      document.getElementById('detailsHeader').style.backgroundImage = `url(${backdropUrl})`;
      
      // Check if TV Show
      const isTvShow = item.media_type === 'tv' || item.first_air_date;
      
      if (isTvShow) {
        document.getElementById('detailsRuntime').textContent = `${item.number_of_seasons || '?'} Seasons`;
        // Show episode selector and load seasons
        document.getElementById('episodeSelector').style.display = 'block';
        await loadTvSeasons(item.id);
      } else {
        document.getElementById('detailsRuntime').textContent = `${item.runtime || '?'} min`;
      }
      
      // Set genres
      const genres = item.genre_ids ? await getGenreNames(item.genre_ids) : 'Various';
      document.getElementById('detailsGenre').textContent = genres;
      
      // Update My List button
      const listBtn = document.getElementById('detailsAddToList');
      const inList = myList.some(i => i.id === item.id);
      if (inList) {
        listBtn.innerHTML = '<span>‚úì</span> In My List';
        listBtn.classList.add('btn-red');
      } else {
        listBtn.innerHTML = '<span>+</span> My List';
        listBtn.classList.remove('btn-red');
      }
      
      // Load cast
      await loadCast(item);
      
      modal.style.display = 'flex';
    }

    async function getGenreNames(ids) {
      try {
        const res = await fetch(`${baseURL}/genre/movie/list?api_key=${API_KEY}`);
        const data = await res.json();
        const names = ids.map(id => {
          const genre = data.genres.find(g => g.id === id);
          return genre ? genre.name : '';
        }).filter(n => n);
        return names.slice(0, 3).join(', ');
      } catch (e) {
        return 'Various';
      }
    }

    async function loadCast(item) {
      const container = document.getElementById('detailsCast');
      container.innerHTML = '';
      
      try {
        const endpoint = item.media_type === 'tv' || item.first_air_date ? 'tv' : 'movie';
        const res = await fetch(`${baseURL}/${endpoint}/${item.id}/credits?api_key=${API_KEY}`);
        const data = await res.json();
        
        const cast = (data.cast || []).slice(0, 6);
        if (cast.length === 0) {
          container.innerHTML = '<div class="cast-member">Cast information unavailable</div>';
          return;
        }
        
        cast.forEach(actor => {
          const div = document.createElement('div');
          div.className = 'cast-member';
          div.textContent = actor.name;
          container.appendChild(div);
        });
      } catch (e) {
        container.innerHTML = '<div class="cast-member">Cast information unavailable</div>';
      }
    }

    function closeDetails() {
      document.getElementById('detailsModal').style.display = 'none';
      currentDetailsItem = null;
      tvSeasonsData = [];
    }

    // Play Content
    function playContent() {
      if (!currentDetailsItem) return;
      
      const modal = document.getElementById('playerModal');
      const iframe = document.getElementById('playerIframe');
      
      const isTvShow = currentDetailsItem.media_type === 'tv' || currentDetailsItem.first_air_date;
      
      let sources;
      if (isTvShow) {
        // Use selected season and episode
        const season = parseInt(document.getElementById('seasonSelect').value) || 1;
        const episode = parseInt(document.getElementById('episodeSelect').value) || 1;
        sources = getTvSources(currentDetailsItem.id, season, episode);
      } else {
        sources = getMovieSources(currentDetailsItem.id);
      }
      
      iframe.src = sources[0];
      modal.style.display = 'flex';
    }

    function closePlayer() {
      document.getElementById('playerModal').style.display = 'none';
      document.getElementById('playerIframe').src = '';
    }

    // Load data
    async function loadCategory(endpoint, containerId, type, genreId = null) {
      try {
        let url = `${baseURL}${endpoint}?api_key=${API_KEY}&language=en-US`;
        if (genreId) url += `&with_genres=${genreId}`;
        
        const res = await fetch(url);
        const data = await res.json();
        const container = document.getElementById(containerId);
        container.innerHTML = '';
        
        const items = (data.results || []).slice(0, 40);
        for (let item of items) {
          item.media_type = type;
          item._cert = await getCertification(item);
          createCard(item, container);
        }
      } catch (e) { console.error(e); }
    }

    // Search
    async function performSearch(query) {
      if (!query.trim()) {
        showHome();
        return;
      }
      
      categoriesContainer.style.display = 'none';
      myListSection.classList.remove('active');
      searchResults.classList.add('active');
      document.getElementById('homeHero').style.display = 'none';
      
      const grid = document.getElementById('searchResultsGrid');
      grid.innerHTML = '';
      
      try {
        const res = await fetch(`${baseURL}/search/multi?api_key=${API_KEY}&query=${encodeURIComponent(query)}`);
        const data = await res.json();
        const filtered = (data.results || []).filter(item => 
          item.media_type === 'movie' || item.media_type === 'tv'
        );
        
        for (let item of filtered) {
          item._cert = await getCertification(item);
          if (certMatchesGroup(item._cert, ratingSelect.value)) {
            createCard(item, grid);
          }
        }
      } catch (e) { console.error(e); }
    }

    // Event listeners
    let searchTimeout;
    searchInput.addEventListener('input', (e) => {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => performSearch(e.target.value), 500);
    });

    ratingSelect.addEventListener('change', () => {
      if (searchInput.value) performSearch(searchInput.value);
    });

    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeDetails();
        closePlayer();
      }
    });

    // Close modals on background click
    document.getElementById('detailsModal').addEventListener('click', (e) => {
      if (e.target.id === 'detailsModal') closeDetails();
    });

    document.getElementById('playerModal').addEventListener('click', (e) => {
      if (e.target.id === 'playerModal') closePlayer();
    });

    // Initial load
    updateMyListCount();
    
    // Load all categories
    loadCategory('/trending/all/day', 'trendingRow', 'movie');
    loadCategory('/movie/popular', 'popularMoviesRow', 'movie');
    loadCategory('/tv/popular', 'popularTvRow', 'tv');
    loadCategory('/discover/movie', 'actionRow', 'movie', '28'); // Action
    loadCategory('/discover/movie', 'comedyRow', 'movie', '35'); // Comedy
    loadCategory('/discover/movie', 'horrorRow', 'movie', '27'); // Horror
    loadCategory('/discover/movie', 'scifiRow', 'movie', '878'); // Sci-Fi
    loadCategory('/discover/movie', 'romanceRow', 'movie', '10749'); // Romance
    loadCategory('/discover/movie', 'thrillerRow', 'movie', '53'); // Thriller
    loadCategory('/discover/movie', 'dramaRow', 'movie', '18'); // Drama
    loadCategory('/discover/movie', 'animationRow', 'movie', '16'); // Animation
    loadCategory('/discover/movie', 'documentaryRow', 'movie', '99'); // Documentary
    loadCategory('/discover/movie', 'crimeRow', 'movie', '80'); // Crime
    loadCategory('/discover/movie', 'fantasyRow', 'movie', '14'); // Fantasy
    loadCategory('/discover/movie', 'warRow', 'movie', '10752'); // War
    loadCategory('/discover/movie', 'westernRow', 'movie', '37'); // Western
    loadCategory('/discover/movie', 'familyRow', 'movie', '10751'); // Family
    loadCategory('/discover/movie', 'mysteryRow', 'movie', '9648'); // Mystery
    loadCategory('/discover/movie', 'musicRow', 'movie', '10402'); // Music
    loadCategory('/discover/movie', 'historyRow', 'movie', '36'); // History
    loadCategory('/discover/movie', 'tvMovieRow', 'movie', '10770'); // TV Movie
  </script>
</body>
</html>
